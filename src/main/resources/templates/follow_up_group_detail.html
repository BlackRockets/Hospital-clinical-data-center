<!DOCTYPE html>
<html lang="zh-cn" xmlns:v-on="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>新建随访组</title>
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link rel="stylesheet" href="../static/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/css/bootstrap-table.css">
    <script src="../static/jQuery/jquery-2.2.3.min.js"></script>
    <script src="../static/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="../static/js/moment-with-locales.min.js"></script>
    <script src="../static/js/bootstrap-datetimepicker.min.js"></script>
    <script src="../static/js/vue.js"></script>
    <!--数据复核-->

</head>
<body>
<div class="container" id="box" >
    <div class="page-header">
        <span class="glyphicon glyphicon-chevron-left"><a href="../templates/group_management.html">返回随访组列表</a></span>
    </div>

    <form role="form" style="color: #0079d7" >
            <div class="row" style="margin-top: 5px">
                <div class="col-md-6">
                    <div class="col-md-8" style="text-align:right">
                        <label>责任医院：</label>
                    </div>
                    <div class="col-md-4">
                        <select class="form-control input-sm" v-model="item.responsibilityHospital">
                            <option>人民医院</option>
                            <option>稷山疯人院</option>
                            <option>黑色玫瑰</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="col-md-4" style="text-align:right">
                        <label>责任科室：</label>
                    </div>
                    <div class="col-md-4" style="text-align:left">
                        <select class="form-control input-sm" v-model="item.responsibilityDepartments">
                            <option>精神病科</option>
                            <option>脑残科</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="row" style="margin-top: 5px">
                <div class="col-md-6">
                    <div class="col-md-8" style="text-align:right">
                        <label>负责人：</label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" v-model="item.personInCharge"  >
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="col-md-4" style="text-align:right">
                        <label>级别：</label>
                    </div>
                    <div class="col-md-4" style="text-align:left">
                        <select class="form-control input-sm" v-model="item.level">
                            <option>1</option>
                            <option>2</option>
                            <option>3</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="row" style="margin-top: 5px">
                <div class="col-md-12">
                    <div class="col-md-4" style="text-align:right">
                        <label>表单名称：</label>
                    </div>
                    <div class="col-md-6">
                        <input type="text" class="form-control" v-model="item.groupName"  >
                    </div>
                </div>

            </div>
            <div class="row" style="margin-top: 5px">
                <div class="col-md-6">
                    <div class="col-md-8" style="text-align:right">
                        <label>联系电话：</label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" v-model="item.telephone">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="col-md-4" style="text-align:right">
                        <label>状态：</label>
                    </div>
                    <div class="col-md-4" style="text-align:left">
                        <select class="form-control input-sm" v-model="item.state">
                            <option>开放</option>
                            <option>关闭</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="row" style="margin-top: 5px">
                <div class="col-md-6">
                    <div class="col-md-8" style="text-align:right">
                        <label>开始日期：</label>
                    </div>
                    <div class='input-group date col-md-4' style="text-align:left" id='datetimepicker1'>
                        <input type='text' class="form-control" />
                        <span class="input-group-addon">
                                <span class="glyphicon glyphicon-calendar">
                                </span>
                            </span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="col-md-4" style="text-align:right">
                        <label>结束日期：</label>
                    </div>
                    <div class='input-group date col-md-4' style="text-align:left" id='datetimepicker2'>
                        <input type='text' class="form-control"/>
                        <span class="input-group-addon">
                                <span class="glyphicon glyphicon-calendar">
                                </span>
                            </span>
                    </div>
                </div>
            </div>
            <div class="row" style="margin-top: 5px">
                <div class="col-md-6">
                    <div class="col-md-8" style="text-align:right">
                        <label>课程编号：</label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" v-model="item.courseNumber"  >
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="col-md-4" style="text-align:right">
                        <label  >患者数量：</label>
                    </div>
                    <div class="col-md-4" style="text-align:left">
                        <input type="text" class="form-control" v-model="item.numberOfPatients"  >
                    </div>
                </div>
            </div>
            <div class="row" style="margin-top: 5px">
                <div class="col-md-12">
                    <div class="col-md-4" style="text-align:right">
                        <label>对照组：</label>
                    </div>
                    <div class="col-md-6">
                        <input type="text" class="form-control"   >
                    </div>
                </div>


            </div>
            <div class="row" style="margin-top: 5px">
                <div class="col-md-12">
                    <div class="col-md-4" style="text-align:right">
                        <label>背景：</label>
                    </div>
                    <div class="col-md-6">
                        <textarea class="form-control" rows="5"  v-model="item.background"></textarea>
                    </div>
                </div>


            </div>
            <div class="row" style="margin-top: 5px">
                <div class="col-md-12" style="text-align: center">
                    <button type="button" style="text-align: center" class="btn btn-success btn-sm" data-dismiss="modal" name="../templates/AuthorityManagementOfWholehospital.html" v-on:click="save">保存</button>
                </div>
            </div>
        </form>


    <div class="row">
        <table id="table"></table>
    </div>
</div>



<script type="text/html" id="barDemo">
    <a v-on:click="preview()">
        <span class="glyphicon glyphicon-zoom-in" aria-hidden="true"></span>
    </a>
</script>


<script>
    var vm = new Vue({
        el: '#box',
        data:{
            item:{
                responsibilityHospital:'',
                responsibilityDepartments:'',
                personInCharge:'sadas',
                level:'',
                groupName:'',
                createPeople:'',
                createTime:'',
                telephone:'',
                state:'',
                startTime:'',
                endTime:'',
                courseNumber:'',
                numberOfPatients:'',
                background:'',
            },
        },
        mounted:function(){
            var item = this.item;
            var formData = null;
            var newHref = window.location.href;
            var num = newHref.indexOf('id=') + 3;
            var len = newHref.length;
            var idVal = newHref.substring(num, len);
            var id = idVal;
            axios.get('/followUpGroupManagement/selectOne?id='+id)
                .then(function (response) {
                    vm.item = response.data;
                }).catch(function () {});
        },
        methods: {
            save: function (event) {
                var startTime = $("#datetimepicker1").find("input").val();
                var endTime = $("#datetimepicker2").find("input").val();
                let formData = this.item;
                formData.startTime = startTime;
                formData.endTime = endTime;
                axios.post('/followUpGroupManagement/updateById', formData)
                    .then(function (response) {
                        if(response.data == 1){
                            alert("保存成功")
                            $("#iframeMain").attr("src","../templates/AuthorityManagementOfWholehospital.html");
                        }
                    })
                    .catch(function (error) {
                        if(error.data != 1){
                            alert("保存失败")
                        }
                    });
            }
        }
    })

    $(function () {
        $('#datetimepicker1').datetimepicker({
            format: 'YYYY-MM-DD',
            locale: moment.locale('zh-cn')
        });
        $('#datetimepicker2').datetimepicker({
            format: 'YYYY-MM-DD',
            locale: moment.locale('zh-cn')
        });
    })

</script>

</body>
</html>